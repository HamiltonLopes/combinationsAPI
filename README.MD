### **<h1 align="center">CombinationsAPI</h1>**

## Team 
  * [Jean Fraga](https://www.linkedin.com/in/jean-fraga/)
  * [Hamilton Lopes](https://www.linkedin.com/in/hamilton-lopes/)
  * [Gustavo Sobreiro](https://www.linkedin.com/in/gustavo-sobreiro-de-assis/)
  * [Hamiceis Pereira](https://www.linkedin.com/in/hamiceis-pereira/)
  * [Beatriz Cunha Guimar√£es](https://www.linkedin.com/in/mbeatrizcg/)
  * [Derek Santos](https://www.linkedin.com/in/derekcsantos/)
  * [Marco Antonio](https://www.linkedin.com/in/marco-antonio-pereira-esteves-005185113/)
  * [Renato Tadeu](https://www.linkedin.com/in/renato-tadeu)
  * [Henrique Scherer](https://www.linkedin.com/in/henrique-scherer/)
  * [Gustavo Rogerio](https://www.linkedin.com/in/fabio-rogerio-234b65223/)


## üíª Sobre a API

API desenvolvida para uso no desafio final no HiringCoders#3 Gama Academy VTEX.

Essa API utiliza duas estruturas de dados complexas para armazenamento de combina√ß√µes de produtos
de vendas, onde em uma delas se encontram as melhores combina√ß√µes de venda de produtos de toda a loja e
a outra as melhores combina√ß√µes de venda por produto, feitas para alimentar alguns componentes em VtexIO.

B√°sicamente a API espera um request do [OrderHook](https://developers.vtex.com/vtex-rest-api/reference/gethookconfiguration) da vtex e a partir
do Id do pedido que √© enviado, ela mapeia todas as combina√ß√µes de itens geradas naquele pedido (se o pedido tiver mais de um item comprado), e 
utiliza a sua l√≥gica para armazenar nas estruturas de dados as combina√ß√µes. Somando uma naquelas que j√° aconteceram anteriormente ou criando um
novo registro das que ocorreram pela primeira vez. Neste mesmo momento √© recalculado todas as combina√ß√µes para saber se alguma das combina√ß√µes
inseridas nesta requisi√ß√£o entraram para as melhores combina√ß√µes da loja. Ap√≥s todo o funcionamento s√£o armazenadas as estruturas de dados no banco
de dados NoSQL da Vtex, o MasterData.

Para retornar as melhores combina√ß√µes da loja por meio da rota `/store-top-combinations` 
a API implementa algoritmos de padr√µes de contagem para eliminar valores duplicados e 
elencar chaves num√©ricamente ordenadas com um array de objetos das combina√ß√µes na propriedade `topStore`. 
A API tbm retorna a propriedade `qty: {}` que cont√©m o n√∫mero de vezes que as combina√ß√µes foram feitas em cada top.

### **Example**

As combina√ß√µes no top 1 aconteceram 39 vezes, no top2 as combina√ß√µes aconteceram 12 vezes. Esses n√∫meros servem para ajudar o lojista 
na tomada de decis√µes ao classificar os produtos com  alta performance que geram lucro com pouco investimento; produtos de alta performance que geram lucro com 
muito investimento; produtos que  tem grande investimento e geram pouca receita - geralmente s√£o os lan√ßamentos; e os produtos de baixa performance que devem ser analisados para serem promovidos ou  realocados.
<img src="https://raw.githubusercontent.com/HamiltonLopes/combinationsAPI/master/assets/store-top-explain.png"  width="1000" height="600"  />

##  Rotas 

### Base-URL: https://hccombinationsapi.tk/combinations-api/v1

### Route | order-processor
![order-processor](http://g.recordit.co/wFzktrh9Bq.gif)


### Route | combinations-by-id/:productId
![combinations-by-id/:productId](http://g.recordit.co/p3iJnHwXuc.gif)


### Route | store-top-combinations
![store-top-combinations](http://g.recordit.co/IDzEuRDv6R.gif)

### Route | raw-top-combinations
![raw-top-combinations](http://g.recordit.co/jPlSlA1e3p.gif)


## Arquitetura
<img src="https://github.com/JeanFragaJS/combinationsAPI-1/blob/master/assets/architecture-vtex-final-challenge.png?raw=true"  width="540" height="506"  />

## Estrutura de dados
![db-schema](https://github.com/HamiltonLopes/combinationsAPI/blob/master/assets/db-schema.png?raw=true)

## Documenta√ß√£o
**Documenta√ß√£o completa no swagger:** [Link](https://hccombinationsapi.tk/combinations-api/v1/docs)

![swagger](http://g.recordit.co/TtFeNeuGVy.gif)




